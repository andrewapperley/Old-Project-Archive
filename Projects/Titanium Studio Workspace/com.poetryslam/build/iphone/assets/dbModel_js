var poemsDB=Ti.Database.install('poemDB.sqlite','version1');poemsDB.close();poemsDB.file.setRemoteBackup(false);var themesDB=Ti.Database.install('PSThemes.sqlite','themesVersion');themesDB.close();themesDB.file.setRemoteBackup(false);var poemData;var poemIDArray;var theIndex;var themeData;exports.loadTheme=function(){themesDB=Ti.Database.open('themesVersion');themeData=themesDB.execute('SELECT * FROM themes');themes.themeArray=[];while(themeData.isValidRow()){themes.themeArray.push({title:themeData.fieldByName('themeName'),active:themeData.fieldByName('isActive'),font:themeData.fieldByName('font')});themeData.next();};themesDB.close();if(themes.themeList)
{themes.themeList.setData(themes.themeArray);}}
exports.savingF=function(){var content=writing.PoemTextArea.value;var theTitle=saving.title.text;poemDB=Ti.Database.open('version1');poemDB.execute('INSERT INTO poems (poem_title,poem_content) VALUES (?,?)',theTitle,content);poemDB.close();};exports.loadingF=function(){poemsDB=Ti.Database.open('version1');poemData=poemsDB.execute('SELECT * FROM poems');poemIDArray=poemsDB.execute('SELECT poem_id FROM poems');if(poemIDArray){theIndex=[];while(poemIDArray.isValidRow()){theIndex.push({id:poemIDArray.fieldByName('poem_id')});poemIDArray.next();};};if(poemData){writing.loading.poemarray=[];while(poemData.isValidRow()){writing.loading.poemarray.push({id:poemData.fieldByName('poem_id'),title:poemData.fieldByName('poem_title'),content:poemData.fieldByName('poem_content'),font:CUSTOM_FONT});poemData.next();};poemsDB.close();};if(writing.loading.loadlist){writing.loading.loadlist.setData(writing.loading.poemarray);};};exports.deletingF=function(){poemDB=Ti.Database.open('version1');poemDB.execute('DELETE FROM poems WHERE 1');poemDB.close();}
exports.delete1f=function(data){poemsDB=Ti.Database.open('version1');var theID=data.index+1;if(data.index==theID-1){poemsDB.execute("DELETE FROM poems WHERE rowid = "+theID);poemsDB.execute("UPDATE poems SET rowid = rowid - 1 WHERE rowid > "+theID);poemsDB.close();}}
exports.poemsDB=poemsDB;